!function(){var a={_$container:$(".cli-container")};a.echo=function(b){a._$container.append(b)},a.clear=function(){a._$container.empty()},a.prompt=function(b,c){var d={label:"",type:"text"};c=$.extend({},d,c),$prompt=$("<div></div>").addClass("cli-prompt"),$label=$("<span></span>").addClass("cli-prompt-label").html(c.label),$input=$("<input/>",{type:c.type}),$input.keydown(function(a){if(13==a.keyCode){var d=$input.val();"password"!=c.type?$input.replaceWith(d):$input.remove(),b(d),a.preventDefault()}}),$prompt.prepend($label).append($input),a.echo($prompt),$input.focus()},a.login=function(){Webos.User.getLogged(function(b){b?a.displayCmdPrompt():(a.clear(),a.prompt(function(b){a.prompt(function(c){Webos.User.login(b,c,[function(){a.displayCmdPrompt()},function(){a.echo("<p>Login incorrect.</p>"),a.login()}])},{label:"Password:",type:"password"})},{label:"Login:"}))})},a.displayCmdPrompt=function(){a._terminal||(a._terminal=new W.Terminal,a._terminal.on("echo",function(b){a.echo(b.contents)})),a._terminal.refreshData([function(){var b=a._terminal.data();if(b.username===!1)return void a.login();var c=b.username+"@"+b.host+":"+b.location+(b.root?"#":"$");a.prompt(function(b){if(!b)return void a.displayCmdPrompt();switch(b){case"":a.displayCmdPrompt();break;case"exit":Webos.User.logout(function(){a.login()});break;default:var c=a._terminal.enterCmd(b,[function(){var b=function(){a.displayCmdPrompt()};c.isRunning()?c.on("stop",function(){b()}):b()},function(){a.displayCmdPrompt()}])}},{label:c})},function(){a.login()}])},Webos.Error.setErrorHandler(function(b){var c;c=b instanceof Webos.Error?b.html.message:b.name+" : "+b.message,a.echo("<p>"+c+"</p>")}),a.login()}();